# 目标检测领域相关tricks


# 1.预处理
目的：对输入数据进行增强，使得网络模型在训练的过程中能更专注于目标特征部分的学习.
## 1. 常用的方式
	(1)图像的随机旋转
	(2)裁剪
	(3)翻转
本质其实是为了让数据集更丰富，让网络能够学习到更多的分布情况。

## 2.图像上叠加信息
	(1)输入数据上增加高斯噪声、椒盐噪声
提升网络对有干扰和成像较差情况下的目标检测能力。
### 1.为什么在原始图像上叠加信息会管用，不会损坏原有的图像信息？？
	（1）叠加噪声。
	目的：
	1.是为了让网络能够适应图像质量不佳情况下的图像检测任务。
	2.也可以一定程度提高对输入图像中待检测目标的仿射变换的适应能力。
	
	（2）对图像上某一特定特征进行增强
	目的：
	突出该方面的特征，使得网络能够首先注意到该种特征并更专注于此类特征的学习。
	因为这种方式只是对图像中的指定特征或位置有变动，并不会整体上对图像的结构有巨大的改变，所以并不会破坏图像的信息可读性。

# 2. 模型预训练参数调整
	1. BFEnet特征擦除网络
这个网络是reid方向的，这个特征擦除和上面讲到的噪声本质上有相似的地方，都是通过在训练时遮蔽一部分特征值，来让网络习惯一定量的噪声干扰，从而增强性能。

应用范围：用在有遮挡的场景下的模型。
	
	2. anchor的调整
	问题：为啥我只训练一类的检测，然后重新计算的anchor6个或者9个anchor尺寸差的都不大，但是在实际检测的时候，却检测不到东西。
	
	原因：对yolov3来说，输出是三个特征图，分别对应小目标，中目标和大目标。比如我们要检测的目标在图像中占比我们人眼感觉应该是比较大的，然后我们统计的框也都是比较大的尺寸，但是在实际训练的时候，并不是说大目标就一定由yolov3的最初设计的大目标输出层输出的。很可能就是由中间目标层输出的，而因为anchor的设计过大，导致训练的网络不收敛的有之，明明收敛了，却检测不到目标的情况也有之。

	解决方案：在设计anchor的时候，首先统计目标框的分布，然后进行聚类，聚类后替换或修改原有的9个anchor中和你计算的anchor相近的几个原有的anchor值。然后再训练，如果框还是不够紧缩，再对某几个框进行精调就可以了，核心思路就是：anchor的分布也要满足对全集的稀疏覆盖而不仅仅是你的当前数据集。

	核心思路：anchor的分布也要满足对全集的稀疏覆盖而不仅仅是你的当前数据集。
	
	3. 后处理的优化(严格说是部署的trick)
	(1)nms
	情况：数据集有遮挡，两个离的比较近的，nms就把有遮挡的那个小目标去掉了。
	技巧：
		在计算nms时候，关注下两个框的中心距离，可以设置中心点距离超过多少的两个框，不做nms，这样，就能避免nms的一部分武断删除检测结果bbox.

	4. 大模型训练时候的一个训练技巧
	问题：同样的模型，用较少的数据训练很快达到了97%map,但是换到大
	数据集以后，卡在93%map不动。

	技巧： warm up。
	就是在大数据下训练模型的时候，先从大数据集上取一部分数据训练模型，然后以这个模型为预训练模型，在大数据集上，增大batchsize再进行训练，至少不会卡在93%。
	
	5. 学习率手动调整策略
	（1）一般方法：
		以步长调整学习率为例

